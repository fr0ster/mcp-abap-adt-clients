# Test Configuration Template for @mcp-abap-adt/adt-clients
# Copy this file to test-config.yaml and configure for your environment
# Builder Tests Configuration
#
# Usage:
#   cp tests/test-config.yaml.template tests/test-config.yaml
#   # Edit test-config.yaml with your specific values
#
# IMPORTANT: Object Naming Convention
# ===================================
# All test objects must use the ZADT_BLD_* naming convention:
# - Classes: ZADT_BLD_CLS01, ZADT_BLD_CLS02, etc.
# - Domains: ZADT_BLD_DOM01, ZADT_BLD_DOM02, etc.
# - Data Elements: ZADT_BLD_DTEL01, ZADT_BLD_DTEL02, etc.
# - Function Modules: Z_ADT_BLD_FM01, Z_ADT_BLD_FM02, etc. (must start with Z_ or Y_)
# - Function Groups: ZADT_BLD_FGR01, ZADT_BLD_FGR02, etc.
# - Interfaces: ZADT_BLD_IF01, ZADT_BLD_IF02, etc.
# - Programs: ZADT_BLD_PROG01, ZADT_BLD_PROG02, etc.
# - Tables: ZADT_BLD_TAB01, ZADT_BLD_TAB02, etc.
# - Structures: ZADT_BLD_STRU01, ZADT_BLD_STRU02, etc.
# - Views: ZADT_BLD_VIEW01, ZADT_BLD_VIEW02, etc.
# - Packages: ZADT_BLD_PKG01, ZADT_BLD_PKG02, etc.
#
# Test settings
test_settings:
  fail_fast: false
  verbose: true
  timeout: 60000  # Global test timeout (60 seconds)
  retry_on_failure: false
  max_retries: 1
  cleanup_after_test: false
  # Timeouts for different operations (in milliseconds)
  timeouts:
    default: 60000
    create: 60000
    delay: 3000  # Delay after delete/create operations
  # Operation delays (milliseconds) - time to wait for SAP to commit operations
  # These delays ensure SAP has time to persist state changes between operations
  operation_delays:
    lock: 3000      # Delay after lock operation (default: 3 seconds)
    unlock: 3000    # Delay after unlock operation (default: 3 seconds)
    update: 3000    # Delay after update operation (default: 3 seconds)
    create: 3000    # Delay after create operation (default: 3 seconds)
    default: 3000   # Default delay for any operation (default: 3 seconds)

# Session persistence configuration
session_config:
  # Enable session persistence (saves cookies and CSRF tokens)
  persist_session: true
  # Directory for session files (relative to project root)
  sessions_dir: ".sessions"
  # Session ID format: {test_name}_{timestamp} or custom
  session_id_format: "auto"  # "auto" or custom string
  # Clean up session after test
  cleanup_session_after_test: false

# Lock persistence configuration
lock_config:
  # Directory for lock files (relative to project root)
  locks_dir: ".locks"
  # Track locks in persistent storage
  persist_locks: true
  # Auto-cleanup locks after test
  cleanup_locks_after_test: true

# Environment configuration
environment:
  default_package: "ZADT_BLD_PKG01"  # Default package for creating objects (used if not specified in test case)
  default_transport: ""  # Default transport request (used if not specified in test case)
  # Cleanup configuration (applies to all tests)
  cleanup_before: true   # Clean up objects before test (default: true)
  cleanup_after: true    # Clean up objects after test (default: true)

# ============================================================================
# BUILDER TESTS
# ============================================================================

# Create Class
create_class:
  test_cases:
    - name: "builder_class"
      enabled: true
      description: "Create test class for ClassBuilder tests"
      params:
        class_name: "ZADT_BLD_CLS01"
        description: "ClassBuilder workflow class"
        # package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        superclass: ""
        final: true
        # Optional: Override operation delays for this specific test (in milliseconds)
        # operation_delays:
        #   lock: 5000      # Custom delay after lock (overrides global setting)
        #   unlock: 5000    # Custom delay after unlock
        #   update: 5000    # Custom delay after update
        #   create: 4000    # Custom delay after create
        source_code: |
          CLASS ZADT_BLD_CLS01 DEFINITION
            PUBLIC
            FINAL
            CREATE PUBLIC .

            PUBLIC SECTION.
              METHODS:
                get_text RETURNING VALUE(rv_text) TYPE string.
            PROTECTED SECTION.
            PRIVATE SECTION.
          ENDCLASS.

          CLASS ZADT_BLD_CLS01 IMPLEMENTATION.
            METHOD get_text.
              rv_text = 'Builder Test'.
            ENDMETHOD.
          ENDCLASS.

# Create Package
create_package:
  test_cases:
    - name: "builder_package"
      enabled: true
      description: "Package reserved for PackageBuilder tests"
      params:
        package_name: "ZADT_BLD_PKG01"          # Parent package (existing)
        test_package: "ZADT_BLD_INNER_PKG01"    # Package created by the test
        super_package: "ZADT_BLD_PKG01"
        description: "PackageBuilder workflow package"
        updated_description: "PackageBuilder workflow package - updated"  # Description for update operation
        package_type: "development"             # Optional: development, main, structure, etc.
        # software_component: "HOME"            # Optional: Software component name (can be empty)
        # transport_layer: ""                   # Optional: Transport layer (can be empty)
        # transport_request: ""                 # Optional: Transport request number (used in query param, not in body)

# Create Domain
create_domain:
  test_cases:
    - name: "builder_domain"
      enabled: true
      description: "Domain used by DomainBuilder workflow tests"
      params:
        domain_name: "ZADT_BLD_DOM01"
        description: "DomainBuilder workflow domain"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        datatype: "CHAR"
        length: 5
        decimals: 0
        lowercase: false
        sign_exists: false

# Create Data Element
create_data_element:
  test_cases:
    - name: "builder_data_element"
      enabled: true
      description: "Data element reserved for DataElementBuilder tests"
      params:
        data_element_name: "ZADT_BLD_DTEL01"
        description: "DataElementBuilder workflow data element"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        # Allowed type_kind values:
        #   - domain
        #   - predefinedAbapType
        #   - refToPredefinedAbapType
        #   - refToDictionaryType
        #   - refToClifType
        type_kind: "predefinedAbapType"
        data_type: "CHAR"
        length: 100
        decimals: 0
        short_label: "Builder"
        medium_label: "Builder Data"
        long_label: "Builder Data Element"
        heading_label: "Builder Data Element"

# Create Interface
create_interface:
  test_cases:
    - name: "builder_interface"
      enabled: true
      description: "Interface reserved for InterfaceBuilder tests"
      params:
        interface_name: "ZADT_BLD_IF01"
        description: "InterfaceBuilder workflow interface"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        source_code: |
          INTERFACE ZADT_BLD_IF01
            PUBLIC .
            METHODS: test_method.
          ENDINTERFACE.

# Create Program
create_program:
  test_cases:
    - name: "builder_program"
      enabled: true
      description: "Program reserved for ProgramBuilder tests"
      params:
        program_name: "ZADT_BLD_PROG01"
        description: "ProgramBuilder workflow report"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        program_type: "executable"
        source_code: |
          REPORT ZADT_BLD_PROG01.
          WRITE: / 'Builder test program'.

# Create Table
create_table:
  test_cases:
    - name: "builder_table"
      enabled: true
      description: "Table reserved for TableBuilder tests"
      params:
        table_name: "ZADT_BLD_TAB01"
        description: "TableBuilder workflow table"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        delivery_class: "A"
        data_class: "APPL0"
        ddl_code: |
          @EndUserText.label: 'Builder test table'
          @AbapCatalog.enhancement.category: #NOT_EXTENSIBLE
          @AbapCatalog.tableCategory: #TRANSPARENT
          @AbapCatalog.deliveryClass: #A
          @AbapCatalog.dataMaintenance: #RESTRICTED
          define table ZADT_BLD_TAB01 {
            key mandt          : abap.clnt not null;
            key builder_id     : abap.char(10) not null;
            description        : abap.char(40);
            last_changed_by    : abap.char(12);
            last_changed_on    : abap.dats;
          }

# Create Structure
create_structure:
  test_cases:
    - name: "builder_structure"
      enabled: true
      description: "Structure reserved for StructureBuilder tests"
      params:
        structure_name: "ZADT_BLD_STRU01"
        description: "StructureBuilder workflow structure"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        ddl_code: |
          @EndUserText.label: 'StructureBuilder workflow structure'
          @AbapCatalog.enhancement.category: #NOT_EXTENSIBLE
          define structure ZADT_BLD_STRU01 {
            mandt : abap.clnt;
            field1 : abap.int1;
          }

# Create View
create_view:
  test_cases:
    - name: "builder_view"
      enabled: true
      description: "View reserved for ViewBuilder tests"
      params:
        view_name: "ZADT_BLD_VIEW01"
        description: "ViewBuilder workflow view"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        ddl_source: |
          @EndUserText.label: 'Builder view on MARA'
          @AbapCatalog.sqlViewName: 'ZADTVW01'
          @AbapCatalog.compiler.compareFilter: true
          @AccessControl.authorizationCheck: #NOT_REQUIRED
          define view ZADT_BLD_VIEW01
            as select from mara
          {
            key mara.matnr,
            mara.ersda,
            mara.pstat
          }

# Create Function Group
create_function_group:
  test_cases:
    - name: "builder_function_group"
      enabled: true
      description: "Function group reserved for FunctionGroupBuilder tests"
      params:
        function_group_name: "ZADT_BLD_FGR_EMPTY"
        description: "FunctionGroupBuilder workflow FUGR"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""

# Create Function Module
create_function_module:
  test_cases:
    - name: "builder_function_module"
      enabled: true
      description: "Function module reserved for FunctionModuleBuilder tests"
      params:
        function_module_name: "Z_ADT_BLD_FM01"  # Must start with Z_ or Y_ (with underscore)
        function_group_name: "ZADT_BLD_FGR02"  # Different from FunctionGroupBuilder test (ZADT_BLD_FGR01)
        description: "FunctionModuleBuilder workflow FM"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        source_code: |
          FUNCTION Z_ADT_BLD_FM01
            IMPORTING
              VALUE(IV_PARAM) TYPE STRING
            EXPORTING
              VALUE(EV_RESULT) TYPE STRING.
            ev_result = |Result: { iv_param }|.
          ENDFUNCTION.

# Create Transport
create_transport:
  test_cases:
    - name: "builder_transport"
      enabled: true
      description: "Transport reserved for TransportBuilder tests"
      params:
        description: "TransportBuilder workflow transport"
        # package_name: "ZADT_BLD_PKG01"

# Standard SAP objects registry for read-only tests
standard_objects:
  classes:
    - name: "CL_ABAP_CHAR_UTILITIES"
      description: "Character utilities helper (available everywhere)"
      available_in: ["onprem", "cloud"]
    - name: "CL_ABAP_CORRESPONDING"
      description: "Corresponding-move helper for ABAP"
      available_in: ["onprem", "cloud"]

  interfaces:
    - name: "IF_BUPA_API_MODIFY"
      description: "Interface zum BAdI: BUPA_API_MODIFY"
      available_in: ["onprem", "cloud"]

  domains:
    - name: "MANDT"
      description: "Client domain"
      available_in: ["onprem", "cloud"]
    - name: "ABAP_BOOL"
      description: "Boolean domain"
      available_in: ["onprem", "cloud"]

  data_elements:
    - name: "MANDT"
      description: "Client data element"
      available_in: ["onprem", "cloud"]
    - name: "ABAP_BOOL"
      description: "Boolean data element"
      available_in: ["onprem", "cloud"]

  tables:
    - name: "T000"
      description: "Client table (on-premise SAP systems)"
      available_in: ["onprem"]
    - name: "T000"
      description: "Clients"
      available_in: ["cloud"]

  structures:
    - name: "SYST"
      description: "System fields structure"
      available_in: ["onprem", "cloud"]

  packages:
    - name: "$TMP"
      description: "Local package"
      available_in: ["onprem"]
    - name: "ZLOCAL"
      description: "Placeholder for ABAP Cloud package â€“ replace with existing package"
      available_in: ["cloud"]

  programs:
    - name: "SAPLSETB"
      description: "Standard SAP settings program"
      available_in: ["onprem"]

  views:
    - name: "H_T000"
      description: "Client table help view"
      available_in: ["onprem"]
    - name: "I_SapPackage"
      description: "ABAP Cloud: replace with CDS view name existing in tenant"
      available_in: ["cloud"]

  function_groups:
    - name: "EDIN"
      description: "System function group"
      available_in: ["onprem", "cloud"]

  function_modules:
    - name: "IDOC_INBOUND_XML_SOAP_HTTP"
      group: "EDIN"
      description: "Returns system metadata"
      available_in: ["onprem", "cloud"]

  standard_criteria:
    note: "Update the entries above with objects that exist in your SAP system before running read tests."
