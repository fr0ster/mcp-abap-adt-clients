# Test Configuration Template for @mcp-abap-adt/adt-clients
# Copy this file to test-config.yaml and configure for your environment
# Builder Tests Configuration
#
# Usage:
#   cp src/__tests__/helpers/test-config.yaml.template src/__tests__/helpers/test-config.yaml
#   # Edit test-config.yaml with your specific values
#
# IMPORTANT: Object Naming Convention
# ===================================
# All test objects must use the ZADT_BLD_* naming convention:
# - Classes: ZADT_BLD_CLS01, ZADT_BLD_CLS02, etc.
# - Domains: ZADT_BLD_DOM01, ZADT_BLD_DOM02, etc.
# - Data Elements: ZADT_BLD_DTEL01, ZADT_BLD_DTEL02, etc.
# - Function Modules: Z_ADT_BLD_FM01, Z_ADT_BLD_FM02, etc. (must start with Z_ or Y_)
# - Function Groups: ZADT_BLD_FGR01, ZADT_BLD_FGR02, etc.
# - Interfaces: ZADT_BLD_IF01, ZADT_BLD_IF02, etc.
# - Programs: ZADT_BLD_PROG01, ZADT_BLD_PROG02, etc.
# - Tables: ZADT_BLD_TAB01, ZADT_BLD_TAB02, etc.
# - Structures: ZADT_BLD_STRU01, ZADT_BLD_STRU02, etc.
# - Views: ZADT_BLD_VIEW01, ZADT_BLD_VIEW02, etc.
# - Service Definitions: ZADT_BLD_SRVD01, ZADT_BLD_SRVD02, etc.
# - Packages: ZADT_BLD_PKG01, ZADT_BLD_PKG02, etc.
#
# Test settings
test_settings:
  fail_fast: false
  verbose: true
  timeout: 60000  # Global test timeout (60 seconds)
  retry_on_failure: false
  max_retries: 1
  cleanup_after_test: false
  # Timeouts for different operations (in milliseconds)
  timeouts:
    default: 60000
    long: 200000  # Long timeout for complex operations (group deletion, etc.)
    create: 60000
    delay: 3000  # Delay after delete/create operations
  # Operation delays (milliseconds) - time to wait for SAP to commit operations
  # These delays ensure SAP has time to persist state changes between operations
  operation_delays:
    lock: 3000      # Delay after lock operation (default: 3 seconds)
    unlock: 3000    # Delay after unlock operation (default: 3 seconds)
    update: 3000    # Delay after update operation (default: 3 seconds)
    create: 3000    # Delay after create operation (default: 3 seconds)
    activate: 3000   # Delay after activate operation (default: 3 seconds)
    default: 3000   # Default delay for any operation (default: 3 seconds)

# Session persistence configuration
session_config:
  # Enable session persistence (saves cookies and CSRF tokens)
  persist_session: true
  # Directory for session files (relative to project root)
  sessions_dir: ".sessions"
  # Session ID format: {test_name}_{timestamp} or custom
  session_id_format: "auto"  # "auto" or custom string
  # Clean up session after test
  cleanup_session_after_test: false

# Lock persistence configuration
lock_config:
  # Directory for lock files (relative to project root)
  locks_dir: ".locks"
  # Track locks in persistent storage
  persist_locks: true

# Environment configuration
environment:
  default_package: "ZADT_BLD_PKG01"  # Default package for creating objects (used if not specified in test case)
  default_transport: ""  # Default transport request (used if not specified in test case)
  skip_cleanup: false    # Skip cleanup after test (objects left for analysis) - can be overridden per test case

# Standard SAP objects registry for read-only tests
standard_objects:
  classes:
    - name: "CL_ABAP_CHAR_UTILITIES"
      description: "Character utilities helper (available everywhere)"
      available_in: ["onprem", "cloud"]
    - name: "CL_ABAP_CORRESPONDING"
      description: "Corresponding-move helper for ABAP"
      available_in: ["onprem", "cloud"]

  interfaces:
    - name: "IF_BUPA_API_MODIFY"
      description: "Interface zum BAdI: BUPA_API_MODIFY"
      available_in: ["onprem", "cloud"]

  domains:
    - name: "MANDT"
      description: "Client domain"
      available_in: ["onprem", "cloud"]
    - name: "ABAP_BOOL"
      description: "Boolean domain"
      available_in: ["onprem", "cloud"]

  data_elements:
    - name: "MANDT"
      description: "Client data element"
      available_in: ["onprem", "cloud"]
    - name: "ABAP_BOOL"
      description: "Boolean data element"
      available_in: ["onprem", "cloud"]

  tables:
    - name: "T000"
      description: "Client table (on-premise SAP systems)"
      available_in: ["onprem"]
    - name: "T000"
      description: "Clients"
      available_in: ["cloud"]

  structures:
    - name: "SYST"
      description: "System fields structure"
      available_in: ["onprem", "cloud"]

  packages:
    - name: "$TMP"
      description: "Local package"
      available_in: ["onprem"]
    - name: "ZLOCAL"
      description: "Placeholder for ABAP Cloud package – replace with existing package"
      available_in: ["cloud"]

  programs:
    - name: "SAPLSETB"
      description: "Standard SAP settings program"
      available_in: ["onprem"]

  views:
    - name: "H_T000"
      description: "Client table help view"
      available_in: ["onprem"]
    - name: "I_SapPackage"
      description: "ABAP Cloud: replace with CDS view name existing in tenant"
      available_in: ["cloud"]

  function_groups:
    - name: "EDIN"
      description: "System function group"
      available_in: ["onprem", "cloud"]

  function_modules:
    - name: "IDOC_INBOUND_XML_SOAP_HTTP"
      group: "EDIN"
      description: "Returns system metadata"
      available_in: ["onprem", "cloud"]

  service_definitions:
    - name: "I_SapPackage"
      description: "ABAP Cloud: replace with service definition name existing in tenant"
      available_in: ["cloud"]
    - name: "ZPLACEHOLDER_SRVD"
      description: "Placeholder for on-premise service definition – replace with existing service definition"
      available_in: ["onprem"]

  standard_criteria:
    note: "Update the entries above with objects that exist in your SAP system before running read tests."

# ============================================================================
# READ TESTS (Read-only operations on existing objects)
# ============================================================================

# Read Service Definition
read_service_definition:
  test_cases:
    - name: "read_standard_service_definition"
      enabled: false  # Set to true and configure params below to enable read test
      description: "Read standard SAP service definition"
      params:
        # Specify standard object name directly (overrides standard_objects registry)
        service_definition_name: "I_SapPackage"  # Replace with existing service definition in your system
        # Or use environment-specific parameters:
        # service_definition_name_cloud: "I_SapPackage"  # For cloud systems only
        # service_definition_name_onprem: "ZPLACEHOLDER_SRVD"  # For on-premise systems only

# ============================================================================
# FLOW TESTS (Create/Update/Delete operations - Builder tests)
# ============================================================================

# Create Class
create_class:
  test_cases:
    - name: "adt_class"
      enabled: true
      description: "Create test class for ClassBuilder tests"
      params:
        class_name: "ZADT_BLD_CLS01"
        description: "ClassBuilder workflow class"
        # package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        superclass: ""
        final: true
        # Optional: Override operation delays for this specific test (in milliseconds)
        # operation_delays:
        #   lock: 5000      # Custom delay after lock (overrides global setting)
        #   unlock: 5000    # Custom delay after unlock
        #   update: 5000    # Custom delay after update
        #   create: 4000    # Custom delay after create
        source_code: |
          CLASS ZADT_BLD_CLS01 DEFINITION
            PUBLIC
            FINAL
            CREATE PUBLIC .

            PUBLIC SECTION.
              TYPES:
                BEGIN OF ty_parent,
                  fld1 TYPE char10,
                  fld2 TYPE string,
                  fld3 TYPE char8,
                END OF ty_parent,
                ty_parent_tab TYPE STANDARD TABLE OF ty_parent WITH DEFAULT KEY,
                BEGIN OF ty_child,
                  parent_id TYPE char10,
                  chld_id   TYPE char10,
                END OF ty_child,
                ty_child_tab TYPE STANDARD TABLE OF ty_child WITH DEFAULT KEY.

              METHODS:
                get_text RETURNING VALUE(rv_text) TYPE string.
              CLASS-METHODS:
                build_parent_data RETURNING VALUE(rt_parent) TYPE ty_parent_tab,
                build_child_data  RETURNING VALUE(rt_child)  TYPE ty_child_tab.
            PROTECTED SECTION.
            PRIVATE SECTION.
          ENDCLASS.

          CLASS ZADT_BLD_CLS01 IMPLEMENTATION.
            METHOD get_text.
              rv_text = |Parents: { lines( build_parent_data( ) ) }|.
            ENDMETHOD.

            METHOD build_parent_data.
              rt_parent = VALUE #(
                ( fld1 = '0000000001' fld2 = 'Parent 1' fld3 = '20250101' )
                ( fld1 = '0000000002' fld2 = 'Parent 2' fld3 = '20250105' )
              ).
            ENDMETHOD.

            METHOD build_child_data.
              rt_child = VALUE #(
                ( parent_id = '0000000001' chld_id = 'C01' )
                ( parent_id = '0000000001' chld_id = 'C02' )
                ( parent_id = '0000000002' chld_id = 'C03' )
              ).
            ENDMETHOD.
          ENDCLASS.

        # Optional ABAP Unit test configuration.
        # Remove the entire block below if you don't want to generate test classes or run ABAP Unit tests.
        test_class:
          enabled: true
          run_unit_test: true
          name: "LTCL_ZADT_BLD_CLS01"
          container_class: "ZADT_BLD_CLS01"
          source_code: |
            CLASS ltcl_zadt_bld_cls01 DEFINITION
              FOR TESTING
              DURATION SHORT
              RISK LEVEL HARMLESS
              FINAL.

              PRIVATE SECTION.
                METHODS parent_data_two_rows FOR TESTING.
                METHODS child_data_relations FOR TESTING.
            ENDCLASS.

            CLASS ltcl_zadt_bld_cls01 IMPLEMENTATION.
              METHOD parent_data_two_rows.
                DATA lt_parent TYPE zadt_bld_cls01=>ty_parent_tab.
                lt_parent = zadt_bld_cls01=>build_parent_data( ).

                cl_abap_unit_assert=>assert_equals(
                  act = lines( lt_parent )
                  exp = 2
                  msg = 'Expected 2 parent rows'
                ).

                DATA(ls_first) = lt_parent[ 1 ].
                cl_abap_unit_assert=>assert_equals(
                  act = ls_first-fld1
                  exp = '0000000001'
                  msg = 'Incorrect key for first parent'
                ).
              ENDMETHOD.

              METHOD child_data_relations.
                DATA lt_parent TYPE zadt_bld_cls01=>ty_parent_tab.
                DATA lt_child  TYPE zadt_bld_cls01=>ty_child_tab.

                lt_parent = zadt_bld_cls01=>build_parent_data( ).
                lt_child  = zadt_bld_cls01=>build_child_data( ).

                cl_abap_unit_assert=>assert_equals(
                  act = lines( lt_child )
                  exp = 3
                  msg = 'Expected 3 child rows'
                ).

                LOOP AT lt_child ASSIGNING FIELD-SYMBOL(<ls_child>).
                  READ TABLE lt_parent WITH KEY fld1 = <ls_child>-parent_id TRANSPORTING NO FIELDS.
                  cl_abap_unit_assert=>assert_equals(
                    act = sy-subrc
                    exp = 0
                    msg = |Invalid parent reference { <ls_child>-parent_id }|
                  ).
                ENDLOOP.
              ENDMETHOD.
            ENDCLASS.

          unit_test_options:
            title: "LTCL_ZADT_BLD_CLS01"
            context: "Builder Class ABAP Unit"
            scope:
              own_tests: true
              foreign_tests: false
              add_foreign_tests_as_preview: true
            risk_level:
              harmless: true
              dangerous: true
              critical: true
            duration:
              short: true
              medium: true
              long: true
          unit_test_status:
            with_long_polling: true
          unit_test_result:
            with_navigation_uris: false
            format: "abapunit"   # or "junit"

# Create Package
create_package:
  test_cases:
    - name: "adt_package"
      enabled: true
      description: "Package reserved for PackageBuilder tests"
      params:
        package_name: "ZADT_BLD_PKG01"          # Parent package (existing)
        test_package: "ZADT_BLD_INNER_PKG01"    # Package created by the test
        description: "PackageBuilder workflow package"
        updated_description: "PackageBuilder workflow package - updated"  # Description for update operation
        package_type: "development"             # Optional: development, main, structure, etc.
        # software_component: "HOME"            # Optional: Software component name (can be empty)
        # transport_layer: ""                   # Optional: Transport layer (can be empty)
        # transport_request: ""                 # Optional: Transport request number (used in query param, not in body)

# Create Domain
create_domain:
  test_cases:
    - name: "adt_domain"
      enabled: true
      description: "Domain used by DomainBuilder workflow tests"
      params:
        domain_name: "ZADT_BLD_DOM01"
        description: "DomainBuilder workflow domain"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        datatype: "CHAR"
        length: 5
        decimals: 0
        lowercase: false
        sign_exists: false

# Create Data Element
create_data_element:
  test_cases:
    - name: "adt_data_element"
      enabled: true
      description: "Data element reserved for DataElementBuilder tests"
      params:
        data_element_name: "ZADT_BLD_DTEL01"
        description: "DataElementBuilder workflow data element"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        # Allowed type_kind values:
        #   - domain
        #   - predefinedAbapType
        #   - refToPredefinedAbapType
        #   - refToDictionaryType
        #   - refToClifType
        type_kind: "predefinedAbapType"
        data_type: "CHAR"
        length: 100
        decimals: 0
        short_label: "Builder"
        medium_label: "Builder Data"
        long_label: "Builder Data Element"
        heading_label: "Builder Data Element"

# Create Interface
create_interface:
  test_cases:
    - name: "adt_interface"
      enabled: true
      description: "Interface reserved for InterfaceBuilder tests"
      params:
        interface_name: "ZADT_BLD_IF01"
        description: "InterfaceBuilder workflow interface"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        source_code: |
          INTERFACE ZADT_BLD_IF01
            PUBLIC .
            METHODS: test_method.
          ENDINTERFACE.
      operation_delays:
        create: 5000  # Increased delay for interface creation
        lock: 3000
        update: 3000
        unlock: 3000

# Create Program
create_program:
  test_cases:
    - name: "adt_program"
      enabled: true
      description: "Program reserved for ProgramBuilder tests"
      params:
        program_name: "ZADT_BLD_PROG01"
        description: "ProgramBuilder workflow report"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        program_type: "executable"
        source_code: |
          REPORT ZADT_BLD_PROG01.
          WRITE: / 'Builder test program'.

# Create Table
create_table:
  test_cases:
    - name: "adt_table"
      enabled: true
      description: "Table reserved for TableBuilder tests"
      params:
        table_name: "ZADT_BLD_TAB01"
        description: "TableBuilder workflow table"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        delivery_class: "A"
        data_class: "APPL0"
        ddl_code: |
          @EndUserText.label: 'Builder test table'
          @AbapCatalog.enhancement.category: #NOT_EXTENSIBLE
          @AbapCatalog.tableCategory: #TRANSPARENT
          @AbapCatalog.deliveryClass: #A
          @AbapCatalog.dataMaintenance: #RESTRICTED
          define table ZADT_BLD_TAB01 {
            key mandt          : abap.clnt not null;
            key builder_id     : abap.char(10) not null;
            description        : abap.char(40);
            last_changed_by    : abap.char(12);
            last_changed_on    : abap.dats;
          }

# Create Structure
create_structure:
  test_cases:
    - name: "adt_structure"
      enabled: true
      description: "Structure reserved for StructureBuilder tests"
      params:
        structure_name: "ZADT_BLD_STRU01"
        description: "StructureBuilder workflow structure"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        ddl_code: |
          @EndUserText.label: 'StructureBuilder workflow structure'
          @AbapCatalog.enhancement.category: #NOT_EXTENSIBLE
          define structure ZADT_BLD_STRU01 {
            mandt : abap.clnt;
            field1 : abap.int1;
          }

# Create View
create_view:
  test_cases:
    - name: "adt_view"
      enabled: true
      description: "View reserved for ViewBuilder tests"
      params:
        package_name: "ZADT_BLD_PKG01"
        table_name: "ZADT_VIEW_TBL01"
        view_name: "ZADT_BLD_VIEW01"
        description: "ViewBuilder workflow view"
        transport_request: ""
        # skip_cleanup: false  # Set to true to skip cleanup after test (objects left for analysis)
        table_source: |
          @EndUserText.label: 'Builder view test table'
          @AbapCatalog.enhancement.category : #NOT_EXTENSIBLE
          @AbapCatalog.tableCategory : #TRANSPARENT
          @AbapCatalog.deliveryClass : #A
          @AbapCatalog.dataMaintenance : #RESTRICTED
          define table zadt_view_tbl01 {
            key client : abap.clnt not null;
            key id     : abap.char(10) not null;
            name       : abap.char(50);
            value      : abap.dec(10,2);
            created_at : abap.dats;
          }
        ddl_source: |
          @EndUserText.label: 'Builder view on custom table'
          @AccessControl.authorizationCheck: #NOT_REQUIRED
          define view entity ZADT_BLD_VIEW01
            as select from zadt_view_tbl01
          {
            key id,
            name,
            value,
            created_at
          }

    - name: "cds_unit_test"
      enabled: true
      description: "CDS view with ABAP Unit verification (CDS view must be created manually before test)"
      params:
        package_name: "ZADT_BLD_PKG03"
        # view_name: CDS view name that must exist and be active (created manually)
        view_name: "ZOK_I_CDS_TEST"
        # skip_cleanup: false  # Set to true to skip cleanup after test (test class left for analysis)
        description: "ViewBuilder CDS unit test view"
        transport_request: ""
        # Note: table_name, table_source, and ddl_source are not used anymore
        # CDS view and table must be created manually before running this test
        cds_unit_test:
          class_name: "ZADT_BLD_CDS_UT02"
          test_class_name: "LTC_ZOK_I_CDS_TEST"
          description: "CDS unit test class"
          transport_request: ""
          template_xml: |
            <abapsource:template abapsource:name="IF_FOR_AUTO_CLASS_GENERATION">
              <abapsource:property abapsource:key="CCAU_CONTENT">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
            &lt;cds:cdstobetested xmlns:cds="http://www.sap.com/adt/cdsfrwk/cds"&gt;
              &lt;cds:cdsundertest api_doc="true" cds_name="ZOK_I_CDS_TEST" cds_test_type="UNIT_TEST"&gt;
                &lt;cds:testmethods&gt;
                  &lt;cds:testmethod test_method_name="AUNIT_FOR_CDS_METHOD"/&gt;
                &lt;/cds:testmethods&gt;
              &lt;/cds:cdsundertest&gt;
            &lt;/cds:cdstobetested&gt;
            </abapsource:property>
              <abapsource:property abapsource:key="Content-Type">application/vnd.sap.adt.oo.cds.codgen.v1+xml</abapsource:property>
            </abapsource:template>
          test_class_source: |
            "!@testing ZADT_BLD_CDS_UT02
            CLASS LTC_ZOK_I_CDS_TEST DEFINITION FINAL
              FOR TESTING RISK LEVEL HARMLESS DURATION SHORT.

              PRIVATE SECTION.
                CLASS-DATA environment TYPE REF TO if_cds_test_environment.

                DATA td_zok_t_cds_test TYPE STANDARD TABLE OF zok_t_cds_test WITH EMPTY KEY.
                DATA act_results TYPE STANDARD TABLE OF zok_i_cds_test WITH EMPTY KEY.

                "! In CLASS_SETUP, corresponding doubles and clone(s) for the CDS view under test and its dependencies are created.
                CLASS-METHODS class_setup RAISING cx_static_check.
                "! In CLASS_TEARDOWN, Generated database entities (doubles & clones) should be deleted at the end of test class execution.
                CLASS-METHODS class_teardown.

                "! SETUP method creates a common start state for each test method,
                "! clear_doubles clears the test data for all the doubles used in the test method before each test method execution.
                METHODS setup RAISING cx_static_check.
                METHODS prepare_testdata.
                "! In this method test data is inserted into the generated double(s) and the test is executed and
                "! the results should be asserted with the actuals.
                METHODS aunit_for_cds_method FOR TESTING RAISING cx_static_check.
            ENDCLASS.

            CLASS LTC_ZOK_I_CDS_TEST IMPLEMENTATION.

              METHOD class_setup.
                environment = cl_cds_test_environment=>create( i_for_entity = 'ZOK_I_CDS_TEST' ).
              ENDMETHOD.

              METHOD setup.
                environment->clear_doubles( ).
              ENDMETHOD.

              METHOD class_teardown.
                environment->destroy( ).
              ENDMETHOD.

              METHOD aunit_for_cds_method.
                prepare_testdata( ).
                SELECT * FROM zok_i_cds_test INTO TABLE @act_results.
                cl_abap_unit_assert=>fail( msg = 'Place your assertions here' ).
              ENDMETHOD.

              METHOD prepare_testdata.
                " Prepare test data for 'zok_t_cds_test'
                td_zok_t_cds_test = VALUE #(
                  (
                    client = '100'
                    fld1 = '100'
                    fld2 = '2222'
                    fld3 = '20251205'
                  )
                  (
                    client = '100'
                    fld1 = '200'
                    fld2 = '4444'
                    fld3 = '20251206'
                  ) ).
                environment->insert_test_data( i_data = td_zok_t_cds_test ).
              ENDMETHOD.

            ENDCLASS.
          unit_test_options:
            title: "LTC_ZOK_I_CDS_TEST"
            context: "ViewBuilder CDS Unit"
            scope:
              own_tests: true
              foreign_tests: false
              add_foreign_tests_as_preview: true
            risk_level:
              harmless: true
              dangerous: true
              critical: true
            duration:
              short: true
              medium: true
              long: true
          unit_test_status:
            with_long_polling: true
          unit_test_result:
            with_navigation_uris: false
            format: "abapunit"

# Create Service Definition
create_service_definition:
  test_cases:
    - name: "adt_service_definition"
      enabled: false  # Set to true and configure params below to enable tests
      description: "Service definition reserved for ServiceDefinitionBuilder tests"
      params:
        service_definition_name: "ZADT_BLD_SRVD01"  # Replace with your service definition name
        description: "ServiceDefinitionBuilder workflow service definition"
        # package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        source_code: |
          @EndUserText.label: 'ServiceDefinitionBuilder workflow service definition'
          define service ZADT_BLD_SRVD01 {
            expose ZOK_C_CDS_TEST;  # Replace with your CDS view name
          }
# Create Function Group
create_function_group:
  test_cases:
    - name: "adt_function_group"
      enabled: true
      description: "Function group reserved for FunctionGroupBuilder tests"
      params:
        function_group_name: "ZADT_BLD_FGR_EMPTY"
        description: "FunctionGroupBuilder workflow FUGR"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""

# Create Function Module
create_function_module:
  test_cases:
    - name: "adt_function_module"
      enabled: true
      description: "Function module reserved for FunctionModuleBuilder tests"
      params:
        function_module_name: "Z_ADT_BLD_FM01"  # Must start with Z_ or Y_ (with underscore)
        function_group_name: "ZADT_BLD_FGR02"  # Different from FunctionGroupBuilder test (ZADT_BLD_FGR01)
        description: "FunctionModuleBuilder workflow FM"
        # package_name: "ZADT_BLD_PKG01"
        # transport_request: ""
        source_code: |
          FUNCTION Z_ADT_BLD_FM01
            IMPORTING
              VALUE(IV_PARAM) TYPE STRING
            EXPORTING
              VALUE(EV_RESULT) TYPE STRING.
            ev_result = |Result: { iv_param }|.
          ENDFUNCTION.

# Create Transport
create_transport:
  test_cases:
    - name: "adt_transport"
      enabled: true
      description: "Transport reserved for TransportBuilder tests"
      params:
        description: "TransportBuilder workflow transport"
        # package_name: "ZADT_BLD_PKG01"

# Create Behavior Definition
create_behavior_definition:
  test_cases:
    - name: "adt_behavior_definition"
      enabled: true
      description: "Create test behavior definition for BehaviorDefinitionBuilder tests"
      params:
        bdef_name: "<YOUR_BEHAVIOR_DEFINITION_NAME>"  # e.g., ZADT_BLD_BDEF01
        description: "Behavior Definition for <YOUR_CDS_VIEW_NAME>"
        package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        root_entity: "<YOUR_CDS_VIEW_NAME>"  # Root entity name (CDS view name)
        implementation_type: "Managed"  # Managed, Unmanaged, Abstract, or Projection
        source_code: |
          managed implementation in class zbp_<your_cds_view_name_lowercase> unique;
          strict ( 2 );

          define behavior for <YOUR_CDS_VIEW_NAME>
          persistent table z_<your_cds_view_name_lowercase>
          lock master
          authorization master ( instance )
          {
            create;
            update;
            delete;
          }

# Create Metadata Extension
create_metadata_extension:
  test_cases:
    - name: "adt_metadata_extension"
      enabled: true
      description: "Create test metadata extension for MetadataExtensionBuilder tests"
      params:
        ext_name: "<YOUR_METADATA_EXTENSION_NAME>"  # e.g., ZADT_BLD_MEXT01
        description: "Metadata Extension for <YOUR_CDS_VIEW_NAME>"
        package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        target_entity: "<YOUR_CDS_VIEW_NAME>"  # Target CDS view name
        source_code: |
          @Metadata.layer: layer
          extend view <YOUR_CDS_VIEW_NAME> with "<YOUR_METADATA_EXTENSION_NAME>"
          {
            @EndUserText.label: 'Sample Field'
            SampleField;
          }

# Create Behavior Implementation
create_behavior_implementation:
  test_cases:
    - name: "adt_behavior_implementation"
      enabled: true
      description: "Create test behavior implementation class for BehaviorImplementationBuilder tests"
      params:
        class_name: "<YOUR_BEHAVIOR_IMPLEMENTATION_CLASS_NAME>"  # e.g., ZBP_<your_cds_view_name>
        description: "Behavior Implementation for <YOUR_BEHAVIOR_DEFINITION_NAME>"
        package_name: "ZADT_BLD_PKG01"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        behavior_definition: "<YOUR_BEHAVIOR_DEFINITION_NAME>"  # Root entity name (BDEF name)
        source_code: |
          CLASS lhc_<your_behavior_definition_name> DEFINITION INHERITING FROM cl_abap_behavior_handler.
            PRIVATE SECTION.

              METHODS get_instance_authorizations FOR INSTANCE AUTHORIZATION
                IMPORTING keys REQUEST requested_authorizations FOR <your_behavior_definition_name_lowercase> RESULT result.

              METHODS get_global_authorizations FOR GLOBAL AUTHORIZATION
                IMPORTING REQUEST requested_authorizations FOR <your_behavior_definition_name_lowercase> RESULT result.

          ENDCLASS.

          CLASS lhc_<your_behavior_definition_name> IMPLEMENTATION.

            METHOD get_instance_authorizations.
            ENDMETHOD.

            METHOD get_global_authorizations.
            ENDMETHOD.

          ENDCLASS.

# Group Activation Test
group_activation:
  test_cases:
    - name: "adt_group_activation"
      enabled: true
      description: "Group activation test - domain, data element, structure"
      params:
        domain_name: "ZADT_BLD_DOM_GRP"
        data_element_name: "ZADT_BLD_DTEL_GRP"
        structure_name: "ZADT_BLD_STRU_GRP"
        description: "Group activation test objects"
        # package_name: "ZADT_BLD_PKG03"  # Uses environment.default_package if omitted
        # transport_request: ""  # Uses environment.default_transport if omitted
        domain_datatype: "CHAR"
        domain_length: 10
        domain_decimals: 0
        data_element_type_kind: "domain"
        structure_ddl_code: |
          @EndUserText.label: 'Group activation test structure'
          @AbapCatalog.enhancement.category: #NOT_EXTENSIBLE
          define structure ZADT_BLD_STRU_GRP {
            mandt : abap.clnt;
            test_field : ZADT_BLD_DTEL_GRP;
          }
